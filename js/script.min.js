(function ($) {
  "use strict";

  var initSwiper = function () {
    new Swiper(".main-swiper", {
      slidesPerView: 3,
      spaceBetween: 80,
      speed: 700,
      loop: true,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      breakpoints: {
        300: {
          slidesPerView: 1.2,
          spaceBetween: 20,
          centeredSlides: true,
        },
        768: {
          slidesPerView: 2,
          spaceBetween: 20,
        },
        1200: {
          slidesPerView: 3,
          spaceBetween: 80,
        },
      },
    });

    new Swiper(".slideshow", {
      slidesPerView: 1,
      spaceBetween: 0,
      speed: 1000,
      loop: true,
      navigation: {
        nextEl: ".icon-arrow-right",
        prevEl: ".icon-arrow-left",
      },
    });

    new Swiper(".two-column-swiper .swiper", {
      slidesPerView: 1,
      loop: true,
      speed: 900,
      navigation: {
        nextEl: ".two-column-swiper .icon-arrow-right",
        prevEl: ".two-column-swiper .icon-arrow-left",
      },
    });

    new Swiper(".overlay-swiper", {
      slidesPerView: "auto",
      loop: true,
      navigation: {
        nextEl: ".icon-arrow-right",
        prevEl: ".icon-arrow-left",
      },
    });

    $(".product-carousel").each(function () {
      var sectionId = $(this).attr("id");
      new Swiper("#" + sectionId + " .swiper", {
        slidesPerView: 4,
        spaceBetween: 20,
        navigation: {
          nextEl: "#" + sectionId + " .icon-arrow-right",
          prevEl: "#" + sectionId + " .icon-arrow-left",
        },
        breakpoints: {
          0: {
            slidesPerView: 2,
            spaceBetween: 20,
            pagination: {
              el: ".swiper-pagination",
              clickable: true,
            },
          },
          999: {
            slidesPerView: 3,
            spaceBetween: 10,
          },
          1366: {
            slidesPerView: 4,
            spaceBetween: 40,
          },
        },
      });
    });

    new Swiper(".testimonial-swiper", {
      effect: "coverflow",
      grabCursor: true,
      centeredSlides: true,
      loop: true,
      slidesPerView: "auto",
      speed: 1500,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      coverflowEffect: {
        fade: true,
      },
      pagination: {
        el: ".testimonial-swiper-pagination",
        clickable: true,
      },
    });

    new Swiper(".review-swiper", {
      slidesPerView: 1,
      spaceBetween: 20,
      loop: true,
      navigation: {
        nextEl: ".icon-arrow-right",
        prevEl: ".icon-arrow-left",
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
    });

    var productThumbSlider = new Swiper(".product-thumbnail-slider", {
      slidesPerView: 3,
      spaceBetween: 20,
      direction: "vertical",
      breakpoints: {
        0: {
          direction: "horizontal",
        },
        992: {
          direction: "vertical",
        },
      },
    });

    new Swiper(".product-large-slider", {
      slidesPerView: 1,
      spaceBetween: 0,
      effect: "fade",
      thumbs: {
        swiper: productThumbSlider,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
    });

    new Swiper(".instagram-swiper", {
      effect: "coverflow",
      grabCursor: true,
      autoplay: {
        delay: 0,
        disableOnInteraction: false,
      },
      speed: 8000,
      grabCursor: true,
      centeredSlides: true,
      slidesPerView: "auto",
      loop: true,
      coverflowEffect: {
        rotate: 0,
        stretch: 0,
        depth: 200,
        modifier: 1,
        slideShadows: false,
      },
      breakpoints: {
        0: {
          slidesPerView: 2,
        },
        576: {
          slidesPerView: 3,
        },
        992: {
          slidesPerView: 4,
        },
        1200: {
          slidesPerView: 6,
        },
      },
    });
  };

  var initProductQty = function () {
    $(".product-qty").each(function () {
      var $el = $(this);
      $el.find(".quantity-right-plus").click(function (e) {
        e.preventDefault();
        var quantity = parseInt($el.find("#quantity").val());
        $el.find("#quantity").val(quantity + 1);
      });
      $el.find(".quantity-left-minus").click(function (e) {
        e.preventDefault();
        var quantity = parseInt($el.find("#quantity").val());
        if (quantity > 0) {
          $el.find("#quantity").val(quantity - 1);
        }
      });
    });
  };

  var initJarallax = function () {
    jarallax(document.querySelectorAll(".jarallax"));
    jarallax(document.querySelectorAll(".jarallax-keep-img"), {
      keepImg: true,
    });
  };

  // Text animation effect
  var initTextFx = function () {
    $(".txt-fx").each(function () {
      var newHtml = "";
      var delay = 0;
      var words = this.textContent.split(/\s/);

      $.each(words, function (index, word) {
        newHtml += '<span class="word">';
        for (var i = 0; i < word.length; i++) {
          newHtml +=
            '<span class="letter" style="transition-delay:' +
            (300 + 10 * delay) +
            'ms;">' +
            word[i] +
            "</span>";
          delay++;
        }
        newHtml += "</span>";

        // Add space
        newHtml +=
          '<span class="letter" style="transition-delay:300ms;">&nbsp;</span>';
        delay++;
      });

      this.innerHTML = newHtml;
    });
  };

  var initStickyHeader = function () {
    if ($(window).scrollTop() >= 200) {
      $(".navbar.fixed-top").addClass("bg-black");
    } else {
      $(".navbar.fixed-top").removeClass("bg-black");
    }
  };

  var initIsotope = function () {
    $(".grid").each(function () {
      var $buttonGroup = $(".button-group");
      var filterValue = $buttonGroup.find(".is-checked").attr("data-filter");
      var $grid = $(".grid").isotope({
        itemSelector: ".product-item",
        layoutMode: "fitRows",
        filter: filterValue,
      });

      $(".button-group").on("click", "a", function (e) {
        e.preventDefault();
        filterValue = $(this).attr("data-filter");
        $grid.isotope({
          filter: filterValue,
        });
      });

      $(".button-group").each(function (i, buttonGroup) {
        $buttonGroup.on("click", "a", function () {
          $buttonGroup.find(".is-checked").removeClass("is-checked");
          $(this).addClass("is-checked");
        });
      });
    });
  };

  var initImageZoom = function () {
    $(".image-zoom")
      .on("mouseover", function () {
        $(this)
          .children(".photo")
          .css({
            transform: "scale(" + $(this).attr("data-scale") + ")",
          });
      })
      .on("mouseout", function () {
        $(this).children(".photo").css({
          transform: "scale(1)",
        });
      })
      .on("mousemove", function (e) {
        $(this)
          .children(".photo")
          .css({
            "transform-origin":
              ((e.pageX - $(this).offset().left) / $(this).width()) * 100 +
              "% " +
              ((e.pageY - $(this).offset().top) / $(this).height()) * 100 +
              "%",
          });
      })
      .each(function () {
        $(this)
          .append('<div class="photo"></div>')
          .children(".photo")
          .css({
            "background-image": "url(" + $(this).attr("data-image") + ")",
          });
      });
  };

  var initSearchPopup = function () {
    $(".navbar").on("click", ".search-button", function (e) {
      $(".search-popup").toggleClass("is-visible");
    });

    $(".navbar").on("click", ".btn-close-search", function (e) {
      $(".search-popup").toggleClass("is-visible");
    });

    $(".search-popup-trigger").on("click", function (e) {
      e.preventDefault();
      $(".search-popup").addClass("is-visible");
      setTimeout(function () {
        $(".search-popup").find("#search-popup").focus();
      }, 350);
    });

    $(".search-popup").on("click", function (e) {
      if (
        $(e.target).is(".search-popup-close") ||
        $(e.target).is(".search-popup-close svg") ||
        $(e.target).is(".search-popup-close path") ||
        $(e.target).is(".search-popup")
      ) {
        e.preventDefault();
        $(this).removeClass("is-visible");
      }
    });

    $(document).keyup(function (e) {
      if (e.which === "27") {
        $(".search-popup").removeClass("is-visible");
      }
    });
  };

  // Window load
  $(window).load(function () {
    $(".preloader").addClass("loaded");
    $(".btn-nav").on("click tap", function () {
      $(".nav-content").toggleClass("showNav hideNav").removeClass("hidden");
      $(this).toggleClass("animated");
    });
    initIsotope();
  });

  // Window scroll
  $(window).scroll(function () {
    initStickyHeader();
  });

  // Document ready
  $(document).ready(function () {
    initSearchPopup();
    initJarallax();
    initTextFx();
    initProductQty();
    initSwiper();
    initImageZoom();

    $(".youtube").colorbox({
      iframe: true,
      innerWidth: 960,
      innerHeight: 585,
    });

    AOS.init({
      duration: 1200,
      once: true,
    });

    new hcSticky(".sticky-info", {
      stickTo: "section.single-product",
      innerTop: 200,
      responsive: {
        980: {
          disable: true,
        },
      },
    });
  });
})(jQuery);
